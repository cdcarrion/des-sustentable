---
title: "Trabajo de Desarrollo Sustentable"
author: 
  - name          : "Cristian Carrión"
  - name          : "Katty Maldonado"
  - name          : "Carol Morales"
date: "13 de abril de 2019"
output: html_document
---

```{r setup, include=FALSE, echo = FALSE, warning = FALSE}
knitr::opts_chunk$set(cache.extra = knitr::rand_seed, comment = NA)
```

# Esperanza de vida H/M (Años)

Fuente: <https://data.worldbank.org>.

```{r plot_life, eval=FALSE, fig.show="animate", message=FALSE, warning=FALSE, include=FALSE, results=T}
p <- ggplot(vida_T, aes(NY.GDP.PCAP.KD, 
                    SP.DYN.LE00.IN, 
                    size = SP.POP.TOTL, 
                    colour = country,
                    label = country)) +
  geom_point(alpha = 0.7, show.legend = F) +
 # scale_colour_manual(values = country_colors) + 
  geom_text(hjust=-.2,vjust=-.2)+
  scale_color_viridis_d(name="")+
  
theme(legend.position = "none",
        plot.caption = element_text(size=9,face="italic"))+
  guides(size=F,color=F)+

  scale_size(range = c(2, 9)) +
  scale_x_log10() +
  facet_wrap(~continent) +
  #gganimate
  labs(title = 'Año: {frame_time}', 
       x = 'GDP per capita', 
       y = 'Esperanza de Vida',
       caption="Fuente: World Bank \nPlot by @cris_cdcc") +
  transition_time(year) +
  ease_aes('linear')

p
```

## North America
 

![](https://media.giphy.com/media/L2x3zEgo4zDC84n2Z6/giphy.gif)

## Asia

![](https://media.giphy.com/media/ViH0Tvn032lOvdPcDa/giphy.gif)

## Europe

![](https://media.giphy.com/media/iDg0axrWuGVVejgXSv/giphy.gif)

## Africa

![](https://media.giphy.com/media/iGdhk6FeKy8Pu7kA6z/giphy.gif)

## South America

![](https://media.giphy.com/media/XyVQvdlyWjSwcV8jNZ/giphy.gif)

# Mortalidad por cada 1000 personas (Personas)

Fuente: <https://www.un.org/en/development/desa/population/index.asp>.

## Hombres

### North America

```{r plot_mort, eval=FALSE, fig.show="animate", message=FALSE, warning=FALSE, include=FALSE, results=T}
p <- ggplot(vida_T, aes(NY.GDP.PCAP.KD, 
                   SP.DYN.AMRT.MA, 
                   size = SP.POP.TOTL, 
                   colour = country,
                   label = country)) +
  geom_point(alpha = 0.7, show.legend = F) +
  #scale_colour_manual(values = country_colors) + 
  geom_text(hjust=-.2,vjust=-.2)+
  scale_color_viridis_d(name="")+
  
  theme(legend.position = "none",
        plot.caption = element_text(size=9,face="italic"))+
  guides(size=F,color=F)+
  
  scale_size(range = c(2, 9)) +
  scale_x_log10() +
  #facet_wrap(~continent) +
  #gganimate
  labs(title = 'Año: {frame_time}', 
       x = 'GDP per capita', 
       y = 'Tasa de mortalidad Hombre',
       caption="Fuente: World Bank\nPlot generated by @cris_cdcc") +
  transition_time(year) +
  ease_aes('linear')

p
```

![](https://media.giphy.com/media/dXETVIAjY8bEbOmKBu/giphy.gif)

### Europe

![](https://media.giphy.com/media/lP4e1IMCSvKrxMJKxZ/giphy.gif)

### Asia

![](https://media.giphy.com/media/IeLviO4wPvJiXEG5T1/giphy.gif)

### Africa

![](https://media.giphy.com/media/hQoBZ2PPU7B4fj5FjN/giphy.gif)

### South America

![](https://media.giphy.com/media/XeFeiyfRgcett2y32Z/giphy.gif)

## Mujeres

### North America

![](https://media.giphy.com/media/TdKv1BqGjiBJUMjgKa/giphy.gif) 

### Europe

![](https://media.giphy.com/media/loX2VECvwDIAQDqcZ1/giphy.gif)

### Asia

![](https://media.giphy.com/media/d8tLwnRByDNtqnUxkD/giphy.gif)

### Africa

![](https://media.giphy.com/media/l0RrcvMEswDZvy0tY1/giphy.gif)

### South America

![](https://media.giphy.com/media/QYMYw4jirUIeXOl7Ot/giphy.gif)

# Tasa de natalidad cruda

## North America

![](https://media.giphy.com/media/cnWU2IPDCrmbNLPpl9/giphy.gif)

## Europe

![](https://media.giphy.com/media/ZF2zsdWzm1XT9rI4W5/giphy.gif)

## Asia

![](https://media.giphy.com/media/JRm0Lyk8hYFFFFQpgQ/giphy.gif)

## Africa 

![](https://media.giphy.com/media/McUdrfyKK8akv76JoS/giphy.gif)

## South America

![](https://media.giphy.com/media/f6UR7ILzwxAmU9foif/giphy.gif)


# Tasa de fertilidad (por mujer)

## North America

![](https://media.giphy.com/media/IgdN2A4LuctJ4tE5iE/giphy.gif)

## Europe

![](https://media.giphy.com/media/TH0FKOoCAo18kYISWb/giphy.gif)

## Asia

![](https://media.giphy.com/media/XcXyOyo3kKSLBVFyrP/giphy.gif)

## Africa 

![](https://media.giphy.com/media/H7NwLS6TyjtO6twKcB/giphy.gif)

## South America

![](https://media.giphy.com/media/TKuuxfN5qQGpjjJomf/giphy.gif)

# Causas de muertes (Personas)

Fuente: <http://ghdx.healthdata.org>.


```{r data, include=FALSE}
library(WDI)
library(wbstats)
library(ggrepel)
library(tidyverse)
library(lubridate)
library(ggthemes)
library(gganimate)


#WDIsearch(string = "",
#          field = "name",
#          short = F)

#WDIsearch("^death*rate.", cache = WDIcache())


vida_T <- data.frame(
  WDI(country = c("US",
                  "CAN",
                  "MEX",
                  
                  "GBR",
                  "ESP",
                  "PRT",
                  "DEU",
                  "FRA",
                  "BEL",
                  "NLD",
                  
                  "CHN",
                  "IND",
                  "BGD",
                  "JPN",
                  "KOR",
                  "PRK",
                  
                  "NGA",
                  "KN",
                  "TZA",
                  "GHA",
                  
                  "BRA",
                  "ECU",
                  "COL",
                  "PER",
                  "BOL"),
      indicator = c("SP.DYN.LE00.IN", #esperanza de vida
                    "SP.POP.TOTL",  #población total
                    "NY.GDP.PCAP.KD", #pib
                    "SP.DYN.AMRT.MA", #tasa mortalidad adulto H 
                    "SP.DYN.AMRT.FE", #tasa mortalidad adulto M
                    "SP.DYN.CBRT.IN", #Tasa cruda de natalidad 
                    "SP.DYN.TFRT.IN"),  #tasa fertilidad
      start = 1985,
      end = 2016,
      extra = F))

vida_T <- mutate(vida_T, 
                 continent = as.factor(case_when(iso2c  == "US" ~ "North America",
                                             iso2c  == "MX" ~ "North America",
                                             iso2c  == "CA" ~ "North America",
                                             
                                             iso2c  == "GB" ~ "Europe",
                                             iso2c  == "ES" ~ "Europe",
                                             iso2c  == "PT" ~ "Europe",
                                             iso2c  == "DE" ~ "Europe",
                                             iso2c  == "FR" ~ "Europe",
                                             iso2c  == "BE" ~ "Europe",
                                             iso2c  == "NL" ~ "Europe",
                                             
                                             iso2c  == "CN" ~ "Asia",
                                             iso2c  == "IN" ~ "Asia",
                                             iso2c  == "BD" ~ "Asia",
                                             iso2c  == "JP" ~ "Asia",
                                             iso2c  == "KR" ~ "Asia",
                                             iso2c  == "KP" ~ "Asia",
                                             
                                             iso2c  == "NG" ~ "Africa",
                                             iso2c  == "KN" ~ "Africa",
                                             iso2c  == "TZ" ~ "Africa",
                                             iso2c  == "GH" ~ "Africa",
                                             
                                             iso2c  == "BR" ~ "South America",
                                             iso2c  == "EC" ~ "South America",
                                             iso2c  == "CO" ~ "South America",
                                             iso2c  == "PE" ~ "South America",
                                             iso2c  == "BO" ~ "South America"
                                             )))
               
```


```{r plot_death, eval=FALSE, fig.show="animate", message=FALSE, warning=FALSE, include=FALSE, results=T}
#
data_deth <- read.csv("C:\\Users\\Usuario\\Desktop\\Teorias del desarrollo\\muertes\\IHME-GBD_2017_DATA-08495555-1.csv",
                                  stringsAsFactors = T)
data_deth <- filter(data_deth, location == "America")
### causas de muertes
caus_deth <- data_deth %>%
  group_by(year) %>%
  # The * 1 makes it possible to have non-integer ranks while sliding
  mutate(rank = min_rank(-val) * 1,
         Value_rel = val/val[rank==1],
         Value_lbl = paste0(" ",val)) %>%
  filter(rank <=10) %>%
  ungroup()

p <- ggplot(caus_deth, aes(rank, group = cause, 
                     fill = cause, color = cause)) +
  geom_tile(aes(y = val/2,
                height = val,
                width = 0.9), alpha = 0.8, color = NA) +
  geom_text(aes(y = 0, label = paste(cause, " ")), vjust = 0.1, hjust = 1) +
  #geom_text(aes(y=val,label = Value_lbl, hjust=0)) +
  coord_flip(clip = "off", expand = FALSE) +
  scale_y_continuous(labels = scales::comma) +
  scale_x_reverse() +
  guides(color = FALSE, fill = FALSE) +
  
  labs(title='Año: {closest_state}', x = "", y = "Causa de muertes",
       caption = "Source: Global Burden of Disease Collaborative Network \nPlot generated by Cristian Carrión") +
  theme(plot.title = element_text(hjust = 0, size = 20),
        axis.ticks.y = element_blank(),  # These relate to the axes post-flip
        axis.text.y  = element_blank(),  # These relate to the axes post-flip
        plot.margin = margin(1,0.9,1,8, "cm")) +  #1) arriba hacia abajo   2) tamaño del plot 3) abajo hacia arriba 4) izq a derecha
  
  transition_states(year, transition_length = 4, state_length = 1) +
  ease_aes('cubic-in-out')

p
```

## America
 

![](https://media.giphy.com/media/j5EFmfu7lYbNqQlqoo/giphy.gif)

## Africa

![](https://media.giphy.com/media/hpLfeM1rYJx9JPRzUB/giphy.gif)

## Asia

![](https://media.giphy.com/media/kxlTifjmkCmAZdPgH7/giphy.gif)

## Europe

![](https://media.giphy.com/media/kGQ2U34CJ6bvJqOJVz/giphy.gif)

## Global

![](https://media.giphy.com/media/QYjrZj58oIVEoDP5EA/giphy.gif)

# Tasa cruda de Matrimonio (Matrimonios)

Fuente: <http://www.oecd.org>.

![](https://media.giphy.com/media/Y0gos2BSm4BoyrvZwo/giphy.gif)

# Tasa cruda de Divorcio (Divorcios)

Fuente: <http://www.oecd.org>.

![](https://media.giphy.com/media/QYq7uySuYrQMarXknw/giphy.gif)



# Tiempo de descomposición de desechos

Fuente: <https://www.ecologiaverde.com/cuanto-tardan-en-degradarse-los-desechos-182.html>.
<https://www.ecoticias.com/residuos-reciclaje/71460/pila-bolsa-plastico-lata-cerveza-cuanto-tardan-desintegrarse>.



| Desecho              | Tiempo de   descomposicion (años) |
|----------------------|:---------------------------------:|
| Plastico             |             150 a 1000            |
| Vidrio               |                4000               |
| Papel                |                 1                 |
| Carton               |                 1                 |
| Caucho               |                100                |
| Latas de   metal     | 30                                |
| Latas de   aluminio  | 10 a 100                          |
| sorbetes             | 1000                              |
| Pilas                | 500 a 1000                        |
| Baterias             | 100 a infinito                    |


# Cobertura de Alcantarillado

Fuente: <http://databank.worldbank.org/data/reports.aspx?source=wdi-database-archives-%28beta%29>.<https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0164571>

![](https://media.giphy.com/media/jRrSN7SOUQT3Kp8Zvb/giphy.gif)

# Cobertura de Agua

![](https://media.giphy.com/media/hs62Cb1o1uiQaehVNX/giphy.gif)
